(this.webpackJsonpopenlayers=this.webpackJsonpopenlayers||[]).push([[0],{135:function(e,t,n){},137:function(e,t,n){},139:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){"use strict";n.r(t);var a=n(27),r=n.n(a),c=n(106),i=n.n(c),s=(n(135),n(64)),o=n.n(s),u=n(79),l=n(114),d=n(85),m=n(146),j=n(113),p=n(153),f=n(3),b=n(152),v=n(102),O=n(84),h=n(147),w=n(149),x=n(151),y=n(83),g=n(112),_=n(111),S=n(104),k=n(148),E=n(68),L=n(57),N=function(e){return(new k.a).writeGetFeature({featureNS:"https://gsavalik.envir.ee/geoserver/maaamet/ows?",srsName:"EPSG:3301",featurePrefix:"maaamet",propertyNames:["geom","l_aadress","pind_m2","ay_nimi"],featureTypes:["ky_kehtiv"],outputFormat:"application/json",filter:Object(E.d)(Object(E.c)("geom",new L.a(e)),Object(E.e)("geom",new L.a(e)))})},A=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://gsavalik.envir.ee/geoserver/maaamet/ows",{method:"POST",body:(new XMLSerializer).serializeToString(N(t))});case 3:return n=e.sent,e.abrupt("return",n.json());case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),F=(n(137),n(17)),T=function(e){var t=e.data;return Object(F.jsxs)("div",{id:"popup",children:[Object(F.jsxs)("div",{className:"address-field",children:[Object(F.jsx)("div",{className:"address-name",children:(null===t||void 0===t?void 0:t.l_aadress)&&"Aadress:"}),Object(F.jsxs)("div",{className:"address-value",children:[Object(F.jsx)("div",{children:null===t||void 0===t?void 0:t.l_aadress}),Object(F.jsx)("div",{children:null===t||void 0===t?void 0:t.ay_nimi})]})]}),Object(F.jsxs)("div",{className:"size-field",children:[Object(F.jsx)("div",{className:"size-name",children:(null===t||void 0===t?void 0:t.pind_m2)&&"Pindala:"}),Object(F.jsx)("div",{className:"size-value",children:(null===t||void 0===t?void 0:t.pind_m2)&&"".concat(null===t||void 0===t?void 0:t.pind_m2," m2")})]})]})},M=(n(139),function(e){var t=e.mapElement,n=e.mapClick,a=e.isLoading;return Object(F.jsxs)(F.Fragment,{children:[a&&Object(F.jsx)("div",{className:"loader",children:"loading..."}),Object(F.jsx)("div",{ref:t,id:"map",onClick:n})]})}),P=(n(140),n(141),function(){var e={l_aadress:"",ay_nimi:"",pind_m2:""},t=Object(a.useState)(new m.a({})),n=Object(d.a)(t,1)[0],r=Object(a.useState)(!1),c=Object(d.a)(r,2),i=c[0],s=c[1],k=Object(a.useState)([]),E=Object(d.a)(k,2),L=E[0],N=E[1],P=Object(a.useState)(e||void 0),C=Object(d.a)(P,2),I=C[0],z=C[1],G=Object(a.useRef)(null),R=Object(f.j)("EPSG:3301"),V=Object(a.useMemo)((function(){return new g.a}),[]),K=Object(a.useMemo)((function(){return new h.a({source:V,style:new v.b({stroke:new O.a({color:"rgba(0, 0, 255, 1.0)",width:2})}),zIndex:1})}),[V]),B=Object(a.useMemo)((function(){return new j.a({center:[55e4,652e4],projection:R,zoom:9,extent:[305744,6323471,805744,6700528],minZoom:9})}),[R]),U=Object(a.useMemo)((function(){return new w.a({source:new _.a({projection:"EPSG:3301",url:"https://tiles.maaamet.ee/tm/tms/1.0.0/foto/{z}/{x}/{-y}.jpg&ASUTUS=MAAAMET&KESKKOND=LIVE&IS=XGIS",tileGrid:new y.a({extent:[40500,5993e3,1064500,7017e3],minZoom:3,resolutions:[4e3,2e3,1e3,500,250,125,62.5,31.25,15.625,7.8125,3.90625,1.953125,.9765625,.48828125]})})})}),[]),D=new x.a({source:new S.a({url:"http://kaart.maaamet.ee/wms/alus?",params:{LAYERS:"MA-ALUS",VERSION:"1.1.1"}})}),J=new x.a({source:new S.a({url:"http://kaart.maaamet.ee/wms/fotokaart?",params:{LAYERS:"MA-FOTOKAART",VERSION:"1.1.1"}})}),X=function(e){var t=new p.a({element:document.getElementById("popup")||void 0});n.addOverlay(t),e&&t.setPosition(e)};Object(a.useEffect)((function(){return n.setTarget(G.current||""),n.addLayer(U),n.setView(B),n.on("rendercomplete",(function(){return s(!1)})),function(){return n.setTarget("")}}),[n,U,B]);var Y=function(e){s(!0),Object(l.a)(n.getLayers().getArray()).forEach((function(e){"VectorLayer"!==e.constructor.name&&n.removeLayer(e)})),n.addLayer(e)};Object(a.useEffect)((function(){n.on("click",function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N(t.coordinate),n.removeLayer(K),V.clear();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[n,N,K,V]);var Z=function(){var t=Object(u.a)(o.a.mark((function t(){var a,r,c,i,s,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(N([]),!L.length){t.next=7;break}return t.next=4,A(L);case 4:a=t.sent,(r=(new b.a).readFeatures(a)).length?(c=a.features[0].properties,i=c.l_aadress,s=c.pind_m2,u=c.ay_nimi,z({l_aadress:i,pind_m2:s,ay_nimi:u}),V.addFeatures(r),n.addLayer(K),X(L)):(z(e),X());case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("div",{className:"button-overlay",children:[Object(F.jsx)("button",{onClick:function(){return Y(D)},children:"image layer 1"}),Object(F.jsx)("button",{onClick:function(){return Y(J)},children:"image layer 2"}),Object(F.jsx)("button",{onClick:function(){return Y(U)},children:"tile layer"})]}),Object(F.jsx)(T,{data:I}),Object(F.jsx)(M,{mapElement:G,isLoading:i,mapClick:function(){return Z()}})]})}),C=n(103),I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,154)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},z=n(110);C.a.defs("EPSG:3301","+proj=lcc+lat_1=59.33333333333334+lat_2=58+lat_0=57.51755393055556+lon_0=24+x_0=500000+y_0=6375000+ellps=GRS80+towgs84=0,0,0,0,0,0,0+units=m+no_defs"),Object(z.a)(C.a),i.a.render(Object(F.jsx)(r.a.StrictMode,{children:Object(F.jsx)(P,{})}),document.getElementById("root")),I()}},[[142,1,2]]]);
//# sourceMappingURL=main.5ca1ff7a.chunk.js.map